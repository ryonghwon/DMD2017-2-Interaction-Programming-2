<!DOCTYPE HTML>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Sprite Animation</title>
<link rel="stylesheet" href="./css/style.css"/>
<script type="text/javascript" src="./js/libs/jquery.min.js"></script>
</head>
<body>
<div id="wrap">
<!-- <div class="zootopia">&nbsp;</div> -->
<div class="cat">&nbsp;</div>
<div class="penguin">&nbsp;</div>
</div>
<script type="text/javascript">
var Sprite;
    $(document).ready(function(){
        Sprite = {
            //반대로 움직이는거 체크
            _isReverse:false,
            _time:0,
            _elCheck:true,
            appInit:function(){
                var _this = Sprite;
                _this.layout();
                _this.reset();
                _this.resetInit();
            },
            layout:function(){
                if(this._elCheck){
                    this.$el = $('.cat');
                }else if(!this._elCheck){
                    this.$el = $('.penguin');
                }
                console.log(this.$el);
            },
            reset:function(){
                //img에 맞게
                if(this._elCheck){
                    this._maxW = 660;
                    this._maxH = 650;
                }else if(!this._elCheck){
                    this._maxW = 740;
                    this._maxH = 450;
                }
                this._cuId = 0;
                this._max = 20;
                this._row = 5;
                this._col = 4;
                this._width = this._maxW / this._col;
                this._height = this._maxH / this._row;
                this.update();
            },
            resetInit:function(){

            },
            play:function(){
                var _this = Sprite;
                console.log("_isReverse : " + _this._isReverse);
                clearInterval(_this._timer);
                _this._timer = setInterval(_this.progress, 60);
            },
            stop:function(){

            },
            progress:function(){
                var _this = Sprite;
                if(!_this._isReverse){
                    //순방향.
                    //1.2.3.4.5
                    _this._cuId++;
                    //console.log("_cuId" +_this._cuId);
                    console.log(_this._cuId);
                }else{
                    _this._cuId--;
                    console.log(_this._cuId);
                    //console.log("_cuId" +_this._cuId);
                }
                if(_this._cuId >= _this._max - 1){
                    // 최근 아이디가 최대 값 보다 크면 최대값 -1
                    _this._cuId = _this._max - 1;
                }else if(_this._cuId < 0){
                    _this._cuId = 0;
                }
                _this.update();
            },
            update:function(){
                var _this = Sprite, x, y;
                x = _this._cuId % _this._row * _this._width * -1;
                y = Math.floor(_this._cuId / _this._col) * _this._height * -1;
                console.log("x : " + x + " y : " + y);
                //x 의 위치. (_this._cuId % _this._row);
                //y 의 위치. (Math.floor(_this._cuId / _this._col));
                _this.$el.css({'background-position':x + 'px ' + y + 'px'});
            }
        };
        Sprite.appInit();

        $('.cat').mouseover(function(){
            console.log("mouseover");
            Sprite._elCheck = true;
            Sprite.layout();
            Sprite.reset();
            Sprite._isReverse = false;
            Sprite.play();
        });
        $('.cat').mouseout(function(){
            console.log("mouseout");
            Sprite._isReverse = true;
            Sprite.play();
        });

        $('.penguin').mouseover(function(){
            console.log("mouseover");
            Sprite._elCheck = false;
            Sprite.layout();
            Sprite.reset();
            Sprite._isReverse = false;
            Sprite.play();
        });
        $('.penguin').mouseout(function(){
            console.log("mouseout");
            Sprite._isReverse = true;
            Sprite.play();
        });
    });
</script>
</body>
</html>