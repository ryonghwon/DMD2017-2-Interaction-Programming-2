<!DOCTYPE HTML>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Image Slider</title>
<link rel="stylesheet" href="./css/style.css"/>
<script type="text/javascript" src="./js/libs/jquery.min.js"></script>
</head>
<body>
<div class="banner">
    <nav class="paddle-nav">
        <ul>
            <li><button class="arrow prev">Previous</button></li>
            <li><button class="arrow next">Next</button></li>
        </ul>
    </nav>
    <nav class="dot-nav">
        <ul>
            <li><span class="selected">&nbsp;</span></li><li>
                <span>&nbsp;</span></li><li>
                <span>&nbsp;</span></li><li>
                <span>&nbsp;</span></li>
        </ul>
    </nav>
    <div class="banner-wrap">
        <div class="banner-container">
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-01.jpg">
                </div>
                <!-- <div class="text-area">
                </div> -->
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-02.jpg">
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-03.jpg">
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-04.jpg">
                </div>
            </div>
        </div>
    </div>
</div>
<!-- <div class="banner">
    <nav role="navigation" class="paddle-nav">
        <ul>
            <li><button class="arrow prev"></button></li>
            <li><button class="arrow next"></button></li>
        </ul>
    </nav>
    <nav class="dot-nav">
        <ul>
        <li><span class="selected">&nbsp;</span></li><li>
            <span>&nbsp;</span></li><li>
            <span>&nbsp;</span></li><li>
            <span>&nbsp;</span></li><li>
        </ul>
    </nav>
    <div class="banner-wrap">
        <div class="banner-container">
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-01.jpg"/>
                </div>
                <div class="component text-area">
                    <div class="title">Title 1</div>
                    <div class="desc">Description 1</div>
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-02.jpg"/>
                </div>
                <div class="component text-area">
                    <div class="title">Title 2</div>
                    <div class="desc">Description 2</div>
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-03.jpg"/>
                </div>
                <div class="component text-area">
                    <div class="title">Title 3</div>
                    <div class="desc">Description 3</div>
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-04.jpg"/>
                </div>
                <div class="component text-area">
                    <div class="title">Title 4</div>
                    <div class="desc">Description 4</div>
                </div>
            </div>
        </div>
    </div>
</div> -->
<script>
(function($){
    $(document).ready(function(){
        //layout.
        var $win, $banner, $bannerWrap, $bannerContainer, $bannerItem, $bannerItemImage, $bannerItemImageEl,
            $dotNav, $paddleNav, $dotEl, $paddleEl, $paddlePrevEl, $paddleNextEl;
        
        var layout = function(){
            //화면에서 사용할 셀렉터 변수 지정하는 함수.
            //$('....')
            $win = $(window);

            $banner = $('.banner');
            $bannerWrap = $banner.children('.banner-wrap');
            $bannerContainer = $bannerWrap.children('.banner-container');
            $bannerItem = $bannerContainer.children('.banner-item');
            $bannerItemImage = $bannerItem.children('.image-area');
            $bannerItemImageEl = $bannerItemImage.children('img');

            $dotNav = $banner.children('.dot-nav');
            $dotNavEl = $dotNav.find('span');

            $paddleNav = $banner.children('.paddle-nav');
            $paddleEl = $paddleNav.find('.arrow');
            $paddlePrevEl = $paddleNav.find('.arrow.prev');
            $paddleNextEl = $paddleNav.find('.arrow.next');
        };
        // function layout(){
        // }
        
        var _cuId, _exId, _max, _bannerW, _isAni;//boolean - 참, 거짓.
        //reset.
        var resetInit = function(){
            //처음에만, 실행되는 함수.
            _cuId = 0;
            _exId = _cuId;
            _max = $bannerItem.length;
            _bannerW = $banner.width();//1000.
            _isAni = false;
            //_isAni = true;
            paddleCheck();
            dotCheck();
        };

        //init.
        var init = function(){
            //이벤트 바인딩하고, 초기에 나온는 것들을 설정하는 함수.
            $paddleEl.on('click', onClickPaddleNav);
            $dotNavEl.on('click', onClickDotNav)

            $win.on('resize', function(){
                onResize();
            });
            $win.trigger('resize');
        };

        //resize.
        var onResize = function(){
            $bannerContainer.width(_bannerW * _max);
            $bannerItem.width(_bannerW);

            //
        };

        //function.
        ///////////
        var onClickPaddleNav = function(e){
            //e, evt, event.
            //Paddle 엘리먼트가 a 태그 같은 링크 가지고 있을 때.
            e.preventDefault();
            if(_isAni) return;
            // if(_isAni){
            //     return;
            // }
            // if(_isAni)
            // return;
            //기본으로 가지고 있는 함수를 막아준다.
            //e 
            //배열로 마우스 속성이 들어온다.
            //e.traget...
            if($(e.target).hasClass('prev')){
                // console.log('이전으로');
                // _cuId 를 1개씩 빼준다.
                _cuId--;
                //0 > -1
                if(_cuId < 0){
                    //음수.
                    _cuId = 0;
                }
            }else if($(e.target).hasClass('next')){
                // console.log('다음으로')
                _cuId++;
                if(_cuId >= _max - 1){
                    _cuId = _max - 1;
                }
                // _cuId 를 1개씩 더해준다.
            // }else{
            }
            // console.log(_cuId);
            //애니메이션.
            if(_exId != _cuId){
                slide();
            }
        };
        var onClickDotNav = function(e){
            e.preventDefault();
            if(_isAni) return;
            var $el = $(this), id;
            //$(this) == $(e.target)
            //id - 몇번째 버튼을 눌렀는지 확인.
            id = $dotNavEl.index(this);
            //console.log(id);
            if(!$el.hasClass('selected')){
                //selected 클래스를 가지고 있지 않을 경우에만 실행.
                _cuId = id;
                if(_exId != _cuId){
                    slide();
                }
            }


            // var $el = $(this), id;
            // console.log('dot click');
            // id = $dotNavEl.index(this);
            // console.log(id + ' 번째');
            //누를 때, id에 맞는 위치로 이동.
        };
        var slide = function(){
            //애니메이션 구간.
            //$bannerContainer
            //1000 * 0 = 0      - 1.
            //1000 * 1 = 1000   - 2.
            //1000 * 2 = 2000   - 3.
            //1000 * 3 = 3000   - 4.
            // $bannerContainer.css({'left':_bannerW * _cuId * -1});
            //이동할 x 좌표.
            var left = _bannerW * _cuId * -1, duration;
            _isAni = true;
            // console.log(_exId);
            //duration 기본값. 400;
            //ex 숫자 - cu 숫자 1,2 +=200
            //ex 3 cu 1  = 2
            //ex 1 cu 3  = -2
            // Math.abs(ex - cu) 
            duration = 200 + Math.abs(_exId - _cuId) * 200;
            console.log(duration);
            $bannerContainer.stop(true).animate({'left' : left}, duration, function(){
                console.log('애니메이션 완료');
                //완료된 시점의 세팅.
                paddleCheck();
                dotCheck();
                _exId = _cuId;
                _isAni = false;
            });
            // $('.banner-container').stop(true).animate({'margin-left' : $('.banner').width() * _id * -1}, 500, function(){
            //         dotSelect();
            //         paddleCheck();
            //         _isAni = false;
            //     }); 
        };

        var paddleCheck = function(){
            //_cuId 0일 때, prev 가 hide(), _cuId _max-1 과 같을 때, next 가 hide().
            $paddleEl.removeClass('disabled');
            if(_cuId == 0){
                $paddlePrevEl.addClass('disabled');
                //120ms 이후에 hide().
                // setTimeout(function(){
                //     $paddlePrevEl.hide();
                // }, 120);
                //0
                // $paddlePrevEl.hide();
                // $paddleNextEl.show();
                //css 클래스 disabled 
            }else if(_cuId == _max -1){
                $paddleNextEl.addClass('disabled');
                //3
                // $paddlePrevEl.show();
                // $paddleNextEl.hide();
            // }else{
                //1, 2
                //$paddlePrevEl.show();
                //$paddleNextEl.show();
                // $paddleEl.show();
            }
        };
        var dotCheck = function(){
            $dotNavEl.removeClass('selected')// 전체 dot 에 selected 클래스를 해제.
            //$dotNavEl.eq(_exId).removeClass('selected')// index 0 인 dot 에 selected 클래스를 해제.
            $dotNavEl.eq(_cuId).addClass('selected');// index 1 인 dot 에 selected 클래스를 추가.
        }

        layout();
        resetInit();
        init();
    });
})(jQuery);
</script>
</body>
</html>