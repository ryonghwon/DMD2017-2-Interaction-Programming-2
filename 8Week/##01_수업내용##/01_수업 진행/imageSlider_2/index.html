<!DOCTYPE HTML>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Image Slider</title>
<link rel="stylesheet" href="./css/style.css"/>
<script type="text/javascript" src="./js/libs/jquery.min.js"></script>
</head>
<body>
<div class="banner">
    <nav class="paddle-nav">
        <ul>
            <li><button class="arrow prev">Previous</button></li>
            <li><button class="arrow next">Next</button></li>
        </ul>
    </nav>
    <nav class="dot-nav">
        <ul>
            <li><span class="selected">&nbsp;</span></li><li>
                <span>&nbsp;</span></li><li>
                <span>&nbsp;</span></li><li>
                <span>&nbsp;</span></li>
        </ul>
    </nav>
    <div class="banner-wrap">
        <div class="banner-container">
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-01.jpg">
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-02.jpg">
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-03.jpg">
                </div>
            </div>
            <div class="banner-item">
                <div class="image-area">
                    <img src="./img/banner/banner-04.jpg">
                </div>
            </div>
        </div>
    </div>
</div>
<script>
(function($){
    $(document).ready(function(){
        var $win, $banner, $bannerWrap, $bannerContainer, $bannerItem, $bannerItemImage, $bannerItemImageEl,
            $dotNav, $paddleNav, $dotEl, $paddleEl, $paddlePrevEl, $paddleNextEl;
        var layout = function(){
            $win = $(window);
            $banner = $('.banner');
            $bannerWrap = $banner.children('.banner-wrap');
            $bannerContainer = $bannerWrap.children('.banner-container');
            $bannerItem = $bannerContainer.children('.banner-item');
            $bannerItemImage = $bannerItem.children('.image-area');
            $bannerItemImageEl = $bannerItemImage.children('img');
            $dotNav = $banner.children('.dot-nav');
            $dotNavEl = $dotNav.find('span');
            $paddleNav = $banner.children('.paddle-nav');
            $paddleEl = $paddleNav.find('.arrow');
            $paddlePrevEl = $paddleNav.find('.arrow.prev');
            $paddleNextEl = $paddleNav.find('.arrow.next');
        };
        var _cuId, _exId, _max, _bannerW, _bannerH, _isAni;
        var resetInit = function(){
            _cuId = 0;
            _exId = _cuId;
            _max = $bannerItem.length;
            //_bannerW = $banner.width();
            _isAni = false;
            paddleCheck();
            dotCheck();
        };
        var init = function(){
            $paddleEl.on('click', onClickPaddleNav);
            $dotNavEl.on('click', onClickDotNav)
            $win.on('resize', function(){
                onResize();
            });
            $win.trigger('resize');
        };
        var onResize = function(){
            _bannerW = $win.width();
            _bannerH = $win.height();
            //console.log(_bannerW, _bannerH);
            $banner.width(_bannerW).height(_bannerH);
            $bannerContainer.width(_bannerW * _max);
            $bannerItem.width(_bannerW);
            var oW = 1000, oH = 768, imgW, imgH, imgT, imgL;
            imgW = _bannerW; //window. width.
            //1000 : 768 = imgW : imgH;
            imgH = Math.round(imgW * oH / oW);
            if(imgH < _bannerH){
                imgH = _bannerH;
                //1000 : 768 = imgW : imgH; 
                imgW = Math.round(imgH * oW / oH);
            }
            imgT = Math.round(_bannerH / 2 - imgH / 2); //1000.001212121...
            //1000.001212121... 반올림. Math.round - 1000.531231 = 1001, 1000.312312 - 1000
            //Math.floor - 내림 : 1000.56328423 -> 1000
            //Math.ceil - 올림 : 1000.12121 -> 1001
            //Math.abs - 절대값 : -1000 > 1000
            imgL = Math.round(_bannerW / 2 - imgW / 2);
            $bannerItemImageEl.width(imgW).height(imgH).css({'margin-top':imgT,'margin-left':imgL});
            // $bannerContainer.width(_bannerW * _max);
            // $bannerItem.width(_bannerW);
            slide(true);
        };
        var onClickPaddleNav = function(e){
            e.preventDefault();
            if(_isAni) return;
            if($(e.target).hasClass('prev')){
                _cuId--;
                if(_cuId < 0){
                    _cuId = 0;
                }
            }else if($(e.target).hasClass('next')){
                _cuId++;
                if(_cuId >= _max - 1){
                    _cuId = _max - 1;
                }
            }
            if(_exId != _cuId){
                slide();
            }
        };
        var onClickDotNav = function(e){
            e.preventDefault();
            if(_isAni) return;
            var $el = $(this), id;
            id = $dotNavEl.index(this);
            if(!$el.hasClass('selected')){
                _cuId = id;
                if(_exId != _cuId){
                    slide();
                }
            }
        };
        var slide = function(b = false){
            var left = _bannerW * _cuId * -1;
            _isAni = true;
            if(!b){
                //false.
                //애니메이션이 될 때.
                var duration;
                duration = 200 + Math.abs(_exId - _cuId) * 200;
                $bannerContainer.stop(true).animate({'left' : left}, duration, function(){
                    paddleCheck();
                    dotCheck();
                    _exId = _cuId;
                    _isAni = false;
                });
            }else{
                //true.
                //리사이즈가 될 때.
                $bannerContainer.stop(true).css({'left' : left});
                _isAni = false;
            }
        };
        var paddleCheck = function(){
            $paddleEl.removeClass('disabled');
            if(_cuId == 0){
                $paddlePrevEl.addClass('disabled');
            }else if(_cuId == _max -1){
                $paddleNextEl.addClass('disabled');
            }
        };
        var dotCheck = function(){
            $dotNavEl.removeClass('selected');
            $dotNavEl.eq(_cuId).addClass('selected');
        }
        layout();
        resetInit();
        init();
    });
})(jQuery);
</script>
</body>
</html>